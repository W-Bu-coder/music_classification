PS C:\Users\buwen\OneDrive\Desktop> python '.\Final CNN-GRU.py'
Device detected: cuda
loading feature files...
success
creating datasets
   Train: 5946 samples, (70.0%)
   Val : 850 samples, (10.0%)
   Test: 1700 samples, (20.0%)
Training start
Epoch 1/60: Train Loss: 1.8265, Val Loss: 1.7522, Train Acc: 0.2997, Val Acc: 0.3212
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.7522 (Val Acc: 0.3212)
Epoch 2/60: Train Loss: 1.6899, Val Loss: 1.5643, Train Acc: 0.3711, Val Acc: 0.4376
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.5643 (Val Acc: 0.4376)
Epoch 3/60: Train Loss: 1.5853, Val Loss: 1.5266, Train Acc: 0.4258, Val Acc: 0.4459
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.5266 (Val Acc: 0.4459)
Epoch 4/60: Train Loss: 1.4983, Val Loss: 1.4542, Train Acc: 0.4542, Val Acc: 0.4788
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.4542 (Val Acc: 0.4788)
Epoch 5/60: Train Loss: 1.4595, Val Loss: 1.4069, Train Acc: 0.4706, Val Acc: 0.5047
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.4069 (Val Acc: 0.5047)
Epoch 6/60: Train Loss: 1.4123, Val Loss: 1.3984, Train Acc: 0.4911, Val Acc: 0.5000
patience: 1/10
Epoch 7/60: Train Loss: 1.3867, Val Loss: 1.3832, Train Acc: 0.5108, Val Acc: 0.5094
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.3832 (Val Acc: 0.5094)
Epoch 8/60: Train Loss: 1.3688, Val Loss: 1.3351, Train Acc: 0.5141, Val Acc: 0.5200
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.3351 (Val Acc: 0.5200)
Epoch 9/60: Train Loss: 1.3376, Val Loss: 1.3608, Train Acc: 0.5235, Val Acc: 0.5153
patience: 1/10
Epoch 10/60: Train Loss: 1.3287, Val Loss: 1.3036, Train Acc: 0.5361, Val Acc: 0.5471
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.3036 (Val Acc: 0.5471)
model saved to: saved_models\cnn_gru_model_20250815_150610_epoch_10.pth
Epoch 11/60: Train Loss: 1.3051, Val Loss: 1.2744, Train Acc: 0.5388, Val Acc: 0.5518
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.2744 (Val Acc: 0.5518)
Epoch 12/60: Train Loss: 1.2859, Val Loss: 1.2985, Train Acc: 0.5533, Val Acc: 0.5341
patience: 1/10
Epoch 13/60: Train Loss: 1.2848, Val Loss: 1.2607, Train Acc: 0.5519, Val Acc: 0.5588
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.2607 (Val Acc: 0.5588)
Epoch 14/60: Train Loss: 1.2575, Val Loss: 1.2928, Train Acc: 0.5636, Val Acc: 0.5435
patience: 1/10
Epoch 15/60: Train Loss: 1.2593, Val Loss: 1.2683, Train Acc: 0.5631, Val Acc: 0.5447
patience: 2/10
Epoch 16/60: Train Loss: 1.2346, Val Loss: 1.2475, Train Acc: 0.5658, Val Acc: 0.5647
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.2475 (Val Acc: 0.5647)
Epoch 17/60: Train Loss: 1.2379, Val Loss: 1.2967, Train Acc: 0.5742, Val Acc: 0.5624
patience: 1/10
Epoch 18/60: Train Loss: 1.2289, Val Loss: 1.2143, Train Acc: 0.5757, Val Acc: 0.5694
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.2143 (Val Acc: 0.5694)
Epoch 19/60: Train Loss: 1.2170, Val Loss: 1.2316, Train Acc: 0.5800, Val Acc: 0.5624
patience: 1/10
Epoch 20/60: Train Loss: 1.2041, Val Loss: 1.3355, Train Acc: 0.5863, Val Acc: 0.5153
patience: 2/10
model saved to: saved_models\cnn_gru_model_20250815_150610_epoch_20.pth
Epoch 21/60: Train Loss: 1.1891, Val Loss: 1.2564, Train Acc: 0.5896, Val Acc: 0.5482
patience: 3/10
Epoch 22/60: Train Loss: 1.1998, Val Loss: 1.2248, Train Acc: 0.5841, Val Acc: 0.5624
patience: 4/10
Epoch 23/60: Train Loss: 1.1792, Val Loss: 1.1985, Train Acc: 0.5983, Val Acc: 0.5812
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.1985 (Val Acc: 0.5812)
Epoch 24/60: Train Loss: 1.1637, Val Loss: 1.2398, Train Acc: 0.5989, Val Acc: 0.5694
patience: 1/10
Epoch 25/60: Train Loss: 1.1538, Val Loss: 1.2156, Train Acc: 0.6044, Val Acc: 0.5694
patience: 2/10
Epoch 26/60: Train Loss: 1.1496, Val Loss: 1.2287, Train Acc: 0.6062, Val Acc: 0.5800
patience: 3/10
Epoch 27/60: Train Loss: 1.1362, Val Loss: 1.1953, Train Acc: 0.6155, Val Acc: 0.5694
patience: 4/10
Epoch 28/60: Train Loss: 1.1467, Val Loss: 1.1643, Train Acc: 0.6030, Val Acc: 0.5835
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.1643 (Val Acc: 0.5835)
Epoch 29/60: Train Loss: 1.1290, Val Loss: 1.2104, Train Acc: 0.6098, Val Acc: 0.5741
patience: 1/10
Epoch 30/60: Train Loss: 1.1470, Val Loss: 1.2181, Train Acc: 0.6084, Val Acc: 0.5776
patience: 2/10
model saved to: saved_models\cnn_gru_model_20250815_150610_epoch_30.pth
Epoch 31/60: Train Loss: 1.1283, Val Loss: 1.1937, Train Acc: 0.6120, Val Acc: 0.5788
patience: 3/10
Epoch 32/60: Train Loss: 1.1287, Val Loss: 1.2467, Train Acc: 0.6143, Val Acc: 0.5706
patience: 4/10
Epoch 33/60: Train Loss: 1.1073, Val Loss: 1.1743, Train Acc: 0.6207, Val Acc: 0.5800
patience: 5/10
Epoch 34/60: Train Loss: 1.0948, Val Loss: 1.1801, Train Acc: 0.6228, Val Acc: 0.5871
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.1801 (Val Acc: 0.5871)
Epoch 35/60: Train Loss: 1.1195, Val Loss: 1.1563, Train Acc: 0.6186, Val Acc: 0.5871
patience: 1/10
Epoch 36/60: Train Loss: 1.0903, Val Loss: 1.2283, Train Acc: 0.6283, Val Acc: 0.5635
patience: 2/10
Epoch 37/60: Train Loss: 1.0921, Val Loss: 1.1603, Train Acc: 0.6291, Val Acc: 0.5847
patience: 3/10
Epoch 38/60: Train Loss: 1.0952, Val Loss: 1.1624, Train Acc: 0.6255, Val Acc: 0.5894
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.1624 (Val Acc: 0.5894)
Epoch 39/60: Train Loss: 1.0933, Val Loss: 1.1587, Train Acc: 0.6244, Val Acc: 0.5988
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.1587 (Val Acc: 0.5988)
Epoch 40/60: Train Loss: 1.0830, Val Loss: 1.2165, Train Acc: 0.6344, Val Acc: 0.5647
patience: 1/10
model saved to: saved_models\cnn_gru_model_20250815_150610_epoch_40.pth
Epoch 41/60: Train Loss: 1.0897, Val Loss: 1.1711, Train Acc: 0.6361, Val Acc: 0.5918
patience: 2/10
Epoch 42/60: Train Loss: 1.0707, Val Loss: 1.1766, Train Acc: 0.6380, Val Acc: 0.5765
patience: 3/10
Epoch 43/60: Train Loss: 1.0784, Val Loss: 1.2049, Train Acc: 0.6356, Val Acc: 0.5729
patience: 4/10
Epoch 44/60: Train Loss: 1.0592, Val Loss: 1.2264, Train Acc: 0.6404, Val Acc: 0.5812
patience: 5/10
Epoch 45/60: Train Loss: 1.0632, Val Loss: 1.1605, Train Acc: 0.6428, Val Acc: 0.5871
patience: 6/10
Epoch 46/60: Train Loss: 1.0146, Val Loss: 1.1313, Train Acc: 0.6558, Val Acc: 0.6035
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.1313 (Val Acc: 0.6035)
Epoch 47/60: Train Loss: 0.9816, Val Loss: 1.1162, Train Acc: 0.6716, Val Acc: 0.6153
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.1162 (Val Acc: 0.6153)
Epoch 48/60: Train Loss: 0.9786, Val Loss: 1.1119, Train Acc: 0.6734, Val Acc: 0.6165
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.1119 (Val Acc: 0.6165)
Epoch 49/60: Train Loss: 0.9748, Val Loss: 1.1219, Train Acc: 0.6719, Val Acc: 0.6118
patience: 1/10
Epoch 50/60: Train Loss: 0.9566, Val Loss: 1.1061, Train Acc: 0.6842, Val Acc: 0.6165
patience: 2/10
model saved to: saved_models\cnn_gru_model_20250815_150610_epoch_50.pth
Epoch 51/60: Train Loss: 0.9607, Val Loss: 1.1162, Train Acc: 0.6835, Val Acc: 0.6129
patience: 3/10
Epoch 52/60: Train Loss: 0.9619, Val Loss: 1.1284, Train Acc: 0.6791, Val Acc: 0.6094
patience: 4/10
Epoch 53/60: Train Loss: 0.9579, Val Loss: 1.1139, Train Acc: 0.6787, Val Acc: 0.6271
model saved to: saved_models\cnn_gru_model_20250815_150610_best.pth
New best Val Loss: 1.1139 (Val Acc: 0.6271)
Epoch 54/60: Train Loss: 0.9469, Val Loss: 1.1253, Train Acc: 0.6802, Val Acc: 0.6094
patience: 1/10
Epoch 55/60: Train Loss: 0.9640, Val Loss: 1.1250, Train Acc: 0.6844, Val Acc: 0.6094
patience: 2/10
Epoch 56/60: Train Loss: 0.9521, Val Loss: 1.1240, Train Acc: 0.6803, Val Acc: 0.6082
patience: 3/10
Epoch 57/60: Train Loss: 0.9499, Val Loss: 1.1283, Train Acc: 0.6878, Val Acc: 0.6094
patience: 4/10
Epoch 58/60: Train Loss: 0.9453, Val Loss: 1.1082, Train Acc: 0.6864, Val Acc: 0.6165
patience: 5/10
Epoch 59/60: Train Loss: 0.9472, Val Loss: 1.1159, Train Acc: 0.6815, Val Acc: 0.6153
patience: 6/10
Epoch 60/60: Train Loss: 0.9327, Val Loss: 1.1122, Train Acc: 0.6864, Val Acc: 0.6176
patience: 7/10
model saved to: saved_models\cnn_gru_model_20250815_150610_epoch_60.pth
model saved to: saved_models\cnn_gru_model_20250815_150610_final.pth
Training history saved: saved_models\cnn_gru_model_20250815_150610_history.json
Training stop
Best Val Acc: 0.6271
Best Epoch: 53
Best Model: saved_models\cnn_gru_model_20250815_150610_best.pth
Evaluate on test set...
model loaded from: saved_models\cnn_gru_model_20250815_150610_best.pth, timestamp: 2025-08-15T15:57:36.793799
Test Acc: 0.6365
               precision    recall  f1-score   support

   Electronic       0.68      0.68      0.68       213
 Experimental       0.44      0.44      0.44       213
         Folk       0.63      0.65      0.64       213
      Hip-Hop       0.64      0.71      0.67       212
 Instrumental       0.70      0.65      0.68       212
International       0.76      0.80      0.78       212
          Pop       0.57      0.56      0.56       213
         Rock       0.66      0.59      0.63       212

     accuracy                           0.64      1700
    macro avg       0.64      0.64      0.64      1700
 weighted avg       0.64      0.64      0.64      1700

Test Acc: 0.6365